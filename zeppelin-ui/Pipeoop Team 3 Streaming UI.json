{"paragraphs":[{"text":"%spark\nimport java.sql.Timestamp\nval df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"topicteam_3sensorpressure\")\n    .load()\n    \nval result = df.selectExpr(\"CAST(value AS STRING)\", \"CAST(timestamp AS TIMESTAMP)\")\n    .as[(String, Timestamp)]\n    .map{ case(value, time) => (value.replace(\"b\", \"\").replace(\"'\", \"\").split(\"-\"), time) }\n    .map{ case(pressures, time) => (pressures(0).toFloat, pressures(1).toFloat, time) }\n    .map{ case(ap, cp, time) => (ap / 3000.0, cp / 3000.0, time) }\n    .toDF(\"air_pressure\", \"cup_pressure\", \"timestamp\")\n        \nval query = result\n    .writeStream\n    .outputMode(\"append\")\n    .format(\"console\")\n    .option(\"truncate\", \"false\")\n    .start()\n    .awaitTermination(20)","user":"anonymous","dateUpdated":"2020-01-12T04:35:14-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import java.sql.Timestamp\ndf: org.apache.spark.sql.DataFrame = [key: binary, value: binary ... 5 more fields]\nresult: org.apache.spark.sql.DataFrame = [air_pressure: double, cup_pressure: double ... 1 more field]\nquery: Boolean = false\n"}]},"apps":[],"jobName":"paragraph_1578792853452_238747615","id":"20200111-173413_253741792","dateCreated":"2020-01-11T17:34:13-0800","dateStarted":"2020-01-12T04:35:14-0800","dateFinished":"2020-01-12T04:37:20-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7346"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2020-01-12T04:31:00-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578832260514_617568511","id":"20200112-043100_1805221046","dateCreated":"2020-01-12T04:31:00-0800","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:7347"}],"name":"Pipeoop Team 3 Streaming UI","id":"2EYB94QNV","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"spark:shared_process":[],"cassandra:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}